% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_multiple_compounds.R
\name{plot_multiple_compounds}
\alias{plot_multiple_compounds}
\title{Plot Multiple Dose-Response Curves Using ggplot2}
\usage{
plot_multiple_compounds(
  results,
  compound_indices = NULL,
  y_limits = c(0, 150),
  point_shapes = NULL,
  colors = NULL,
  legend_position = "right",
  show_grid = FALSE,
  show_legend = TRUE,
  save_plot = NULL,
  plot_width = 10,
  plot_height = 8,
  plot_dpi = 600,
  axis_label_size = 14,
  axis_text_size = 14,
  show_error_bars = TRUE,
  error_bar_width = 0.05,
  plot_title = "Multiple Dose-Response Curves",
  legend_text_size = NULL,
  legend_title_size = 11,
  legend_key_height = NULL,
  legend_ncol = NULL,
  legend_label_wrap = 25,
  plot_ratio = 0.7,
  legend_title = NULL
)
}
\arguments{
\item{results}{List object returned by \code{\link{fit_dose_response}} containing
dose-response analysis results.}

\item{compound_indices}{Numeric vector specifying which compounds to plot.
If NULL, plots all available compounds (default: NULL).}

\item{y_limits}{Numeric vector of length 2 specifying y-axis limits (default: c(0, 150)).}

\item{point_shapes}{Numeric vector of point shapes for each compound. If NULL,
generates optimal shapes automatically based on number of compounds (default: NULL).}

\item{colors}{Character vector of colors for each compound. If NULL, uses black
for all compounds (default: NULL). Provide custom colors for colored output.}

\item{legend_position}{Character specifying legend position: "right", "left",
"top", "bottom", or "none" (default: "right").}

\item{show_grid}{Logical indicating whether to show background grid (default: FALSE).}

\item{show_legend}{Logical indicating whether to show legend (default: TRUE).}

\item{save_plot}{Either a file path for saving the plot, or TRUE for automatic naming
(default: NULL, no saving).}

\item{plot_width}{Plot width in inches for saved plots (default: 10).}

\item{plot_height}{Plot height in inches for saved plots (default: 8).}

\item{plot_dpi}{Resolution for saved raster images (default: 600).}

\item{axis_label_size}{Font size for axis labels (default: 14).}

\item{axis_text_size}{Font size for axis numbers (default: 14).}

\item{show_error_bars}{Logical indicating whether to show error bars (default: TRUE).}

\item{error_bar_width}{Width of error bar ends (default: 0.05).}

\item{plot_title}{Character string for plot title (default: "Multiple Dose-Response Curves").}

\item{legend_text_size}{Font size for legend text. If NULL, automatically adjusts
based on number of compounds (default: NULL).}

\item{legend_title_size}{Font size for legend title (default: 11).}

\item{legend_key_height}{Height of legend key in points. If NULL, automatically
adjusts based on number of compounds (default: NULL).}

\item{legend_ncol}{Number of columns in legend. If NULL, automatically determines
optimal number (default: NULL).}

\item{legend_label_wrap}{Maximum characters per line in legend labels before
wrapping (default: 25).}

\item{plot_ratio}{Numeric ratio of plot area allocated to main plot vs legend
area (default: 0.7).}

\item{legend_title}{Character string for legend title. If NULL, no title is shown
(default: NULL).}
}
\value{
Returns a ggplot object with comprehensive metadata stored as attributes:
\itemize{
\item \code{compound_names}: Names of plotted compounds
\item \code{compound_indices}: Indices of plotted compounds
\item \code{n_compounds}: Number of compounds plotted
\item \code{point_shapes}: Point shapes used for each compound
\item \code{colors}: Colors used for each compound
\item \code{point_size}: Point size used in plot
\item \code{legend_position}: Legend position used
\item \code{legend_ncol}: Number of columns in legend
\item \code{legend_text_size}: Legend text size used
\item \code{legend_key_height}: Legend key height used
\item \code{legend_title}: Legend title used
\item \code{x_limits}: X-axis limits used
\item \code{plot_dimensions}: Dimensions of the plot (width, height, dpi)
\item \code{file_saved}: Path to saved file if plot was saved
}
}
\description{
Creates composite plots showing multiple dose-response curves with professional
styling, flexible legend placement, and intelligent defaults. Optimized for
scientific publications with black-and-white or color output options.
}
\details{
This function creates professional multi-curve dose-response plots using ggplot2
with intelligent defaults optimized for scientific publications. The default
styling uses black lines with different point shapes for optimal differentiation
in black-and-white publications, while supporting custom colors for presentations.

\strong{Key Features:}
\itemize{
\item \strong{Black-and-white optimized}: Default uses black lines with distinct point shapes
\item \strong{Smart point selection}: Automatically chooses optimal point shapes based on compound count
\item \strong{Adaptive sizing}: Point sizes and legend elements adjust based on number of compounds
\item \strong{Intelligent text wrapping}: Automatically wraps long compound names in legend
\item \strong{Professional styling}: Clean, publication-ready appearance with customizable elements
\item \strong{Self-contained}: No external package loading required
}

\strong{Automatic Adjustments:}
\itemize{
\item \strong{Point shapes}: Uses most distinguishable shapes first, recycles intelligently
\item \strong{Point size}: Larger points for few compounds (3.5), smaller for many (2.5)
\item \strong{Legend text}: Smaller text for many compounds (9pt), larger for few (11pt)
\item \strong{Legend columns}: Single column for <=10 compounds, two columns for >10 compounds
\item \strong{X-axis limits}: Automatically calculated from data with 5\% margin
}
}
\examples{
\dontrun{
# Example 1: Default black-and-white with automatic point shapes
analysis_results <- fit_dose_response(my_data, normalize = TRUE)

# Plot compounds with default settings (black lines, different point shapes)
p <- plot_multiple_compounds(
  analysis_results,
  compound_indices = c(1, 3, 5, 7),
  plot_title = "Selected Compound Comparison"
)
print(p)

# Example 2: Custom colors for presentation
p <- plot_multiple_compounds(
  analysis_results,
  compound_indices = 1:4,
  colors = c("#E41A1C", "#377EB8", "#4DAF4A", "#984EA3"), # ColorBrewer palette
  plot_title = "Colored Dose-Response Curves",
  legend_title = "Test Compounds"
)
print(p)

# Example 3: Publication-ready with custom point shapes
p <- plot_multiple_compounds(
  analysis_results,
  compound_indices = 1:6,
  point_shapes = c(15, 16, 17, 18, 0, 1), # Specific shapes
  plot_title = "Custom Point Shapes",
  legend_position = "bottom",
  legend_ncol = 3
)
print(p)

# Example 4: Many compounds with optimized layout
p <- plot_multiple_compounds(
  analysis_results,
  compound_indices = 1:15,
  plot_title = "High-Throughput Screening",
  legend_text_size = 8,
  plot_width = 12,
  save_plot = "screening_results.png"
)
print(p)

# Example 5: Access and use plot metadata
p <- plot_multiple_compounds(
  analysis_results,
  compound_indices = c(2, 4, 6)
)

# Extract metadata for reproducibility
meta <- attr(p, "metadata")
cat("Plotted", meta$n_compounds, "compounds\n")
cat("Point shapes:", meta$point_shapes, "\n")
cat("X-axis range:", round(meta$x_limits, 2), "\n")

# Save styling information
styling_info <- data.frame(
  Compound = meta$compound_names,
  PointShape = meta$point_shapes,
  Color = meta$colors
)
write.csv(styling_info, "plot_styling.csv", row.names = FALSE)
}

}
\seealso{
\code{\link{fit_dose_response}} for generating input data
\code{\link[ggplot2]{ggplot}} for underlying plotting functionality
}
