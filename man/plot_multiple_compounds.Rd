% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_multiple_compounds.R
\name{plot_multiple_compounds}
\alias{plot_multiple_compounds}
\title{Plot Multiple Dose-Response Curves}
\usage{
plot_multiple_compounds(
  results,
  compound_indices = NULL,
  y_limits = c(0, 150),
  point_shapes = NULL,
  colors = NULL,
  legend_position = "right",
  show_grid = FALSE,
  show_legend = TRUE,
  save_plot = NULL,
  plot_width = 10,
  plot_height = 8,
  plot_dpi = 600,
  axis_label_size = 14,
  axis_text_size = 14,
  show_error_bars = TRUE,
  error_bar_width = 0.05,
  plot_title = NULL,
  legend_text_size = NULL,
  legend_title_size = 11,
  legend_key_height = NULL,
  legend_ncol = NULL,
  legend_label_wrap = 25,
  plot_ratio = 0.7,
  legend_title = NULL,
  legend_labels = NULL
)
}
\arguments{
\item{results}{List containing dose-response analysis results with detailed_results
component containing individual compound fits}

\item{compound_indices}{Numeric vector specifying which compounds to include in the plot}

\item{y_limits}{Numeric vector of length 2 specifying the y-axis limits}

\item{point_shapes}{Numeric vector of point shapes for different compounds}

\item{colors}{Character vector of colors for different compound curves}

\item{legend_position}{Character specifying legend position}

\item{show_grid}{Logical indicating whether to show background grid lines}

\item{show_legend}{Logical indicating whether to display the legend}

\item{save_plot}{Character string with filename to save plot or logical to auto-generate filename}

\item{plot_width}{Numeric value for plot width in inches}

\item{plot_height}{Numeric value for plot height in inches}

\item{plot_dpi}{Numeric value for plot resolution in dots per inch}

\item{axis_label_size}{Numeric value for axis title font size}

\item{axis_text_size}{Numeric value for axis tick label font size}

\item{show_error_bars}{Logical indicating whether to display error bars around data points}

\item{error_bar_width}{Numeric value controlling the width of error bars}

\item{plot_title}{Character string for plot title (NULL for automatic title generation)}

\item{legend_text_size}{Numeric value for legend text font size}

\item{legend_title_size}{Numeric value for legend title font size}

\item{legend_key_height}{Numeric value for height of legend keys}

\item{legend_ncol}{Numeric value specifying number of columns in legend}

\item{legend_label_wrap}{Numeric value specifying maximum characters per line in legend labels}

\item{plot_ratio}{Numeric value for plot aspect ratio (width/height)}

\item{legend_title}{Character string for legend title}

\item{legend_labels}{Character vector of custom labels for legend (overrides compound names)}
}
\value{
ggplot object with additional metadata stored as attribute containing:
\itemize{
\item compound_names: Original compound names
\item compound_indices: Indices used for plotting
\item n_compounds: Number of valid compounds plotted
\item point_shapes: Point shapes used
\item colors: Colors used
\item legend_position: Legend position
\item legend_ncol: Number of legend columns
\item legend_text_size: Legend text size
\item legend_key_height: Legend key height
\item legend_title: Legend title used
\item legend_labels_used: Legend labels actually used
\item wrapped_labels: Labels after text wrapping applied
\item x_limits: X-axis limits used
\item plot_dimensions: Plot dimensions and resolution
\item file_saved: Filename if plot was saved
\item smart_title_used: Title actually displayed on plot
}
}
}
\description{
Generates a composite plot of multiple dose-response curves with customizable
appearance and intelligent title generation. The function automatically
determines optimal plot settings based on the number of compounds and
generates intelligent titles when compounds share the same target or compound name.
}
\details{
This function creates professional multi-curve dose-response plots using ggplot2
with intelligent defaults optimized for scientific publications. The default
styling uses black lines with different point shapes for optimal differentiation
in black-and-white publications, while supporting custom colors for presentations.

\strong{Key Features:}
\itemize{
\item \strong{Black-and-white optimized}: Default uses black lines with distinct point shapes
\item \strong{Smart point selection}: Automatically chooses optimal point shapes based on compound count
\item \strong{Adaptive sizing}: Point sizes and legend elements adjust based on number of compounds
\item \strong{Intelligent text wrapping}: Automatically wraps long compound names in legend
\item \strong{Professional styling}: Clean, publication-ready appearance with customizable elements
\item \strong{Self-contained}: No external package loading required
}

\strong{Automatic Adjustments:}
\itemize{
\item \strong{Point shapes}: Uses most distinguishable shapes first, recycles intelligently
\item \strong{Point size}: Larger points for few compounds (3.5), smaller for many (2.5)
\item \strong{Legend text}: Smaller text for many compounds (9pt), larger for few (11pt)
\item \strong{Legend columns}: Single column for <=10 compounds, two columns for >10 compounds
\item \strong{X-axis limits}: Automatically calculated from data with 5\% margin
}
}
\examples{
\dontrun{
# Example 1: Default black-and-white with automatic point shapes
analysis_results <- fit_dose_response(my_data, normalize = TRUE)

# Plot compounds with default settings (black lines, different point shapes)
p <- plot_multiple_compounds(
  analysis_results,
  compound_indices = c(1, 3, 5, 7),
  plot_title = "Selected Compound Comparison"
)
print(p)

# Example 2: Custom colors for presentation
p <- plot_multiple_compounds(
  analysis_results,
  compound_indices = 1:4,
  colors = c("#E41A1C", "#377EB8", "#4DAF4A", "#984EA3"), # ColorBrewer palette
  plot_title = "Colored Dose-Response Curves",
  legend_title = "Test Compounds"
)
print(p)

# Example 3: Publication-ready with custom point shapes
p <- plot_multiple_compounds(
  analysis_results,
  compound_indices = 1:6,
  point_shapes = c(15, 16, 17, 18, 0, 1), # Specific shapes
  plot_title = "Custom Point Shapes",
  legend_position = "bottom",
  legend_ncol = 3
)
print(p)



# Example 4: Custom legend labels and title
plot_multiple_compounds(results,
                       legend_labels = c("Experiment 1", "Experiment 2", "Experiment 3"),
                       plot_title = "My Custom Title")


# Extract metadata for reproducibility
meta <- attr(p, "metadata")
cat("Plotted", meta$n_compounds, "compounds\n")
cat("Point shapes:", meta$point_shapes, "\n")
cat("X-axis range:", round(meta$x_limits, 2), "\n")

# Save styling information
styling_info <- data.frame(
  Compound = meta$compound_names,
  PointShape = meta$point_shapes,
  Color = meta$colors
)
write.csv(styling_info, "plot_styling.csv", row.names = FALSE)
}

}
\seealso{
\code{\link{fit_dose_response}} for generating input data
\code{\link[ggplot2]{ggplot}} for underlying plotting functionality
}
