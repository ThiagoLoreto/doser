% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_dose_response.R
\name{plot_dose_response}
\alias{plot_dose_response}
\title{Plot Dose-Response Curves with ggplot2}
\usage{
plot_dose_response(
  results,
  compound_index = 1,
  y_limits = c(0, 150),
  point_color = "black",
  line_color = "black",
  ic50_line_color = "gray",
  point_size = 1,
  line_width = 2,
  error_bar_width = 0.01,
  show_ic50_line = TRUE,
  show_legend = TRUE,
  show_grid = FALSE,
  save_plot = NULL,
  plot_width = 10,
  plot_height = 8,
  plot_dpi = 600,
  axis_label_size = 14,
  axis_text_size = 14,
  x_axis_title = NULL,
  y_axis_title = NULL,
  enforce_bottom_threshold = NULL,
  bottom_threshold = 60,
  verbose = FALSE
)
}
\arguments{
\item{results}{List object returned by \code{\link{fit_drc_3pl}} containing
dose-response analysis results.}

\item{compound_index}{Numeric index specifying which compound to plot (default: 1).}

\item{y_limits}{Numeric vector of length 2 specifying y-axis limits (default: c(0, 150)).}

\item{point_color}{Color for data points (default: "black").}

\item{line_color}{Color for fitted curve (default: "black").}

\item{ic50_line_color}{Color for IC50 vertical line (default: "gray").}

\item{point_size}{Size multiplier for data points (default: 1).}

\item{line_width}{Line width for fitted curve (default: 2).}

\item{error_bar_width}{Width of error bar ends (default: 0.01).}

\item{show_ic50_line}{Logical indicating whether to show vertical IC50 line (default: TRUE).}

\item{show_legend}{Logical indicating whether to show parameter legend (default: FALSE).}

\item{show_grid}{Logical indicating whether to show background grid (default: FALSE).}

\item{save_plot}{Defines whether to save the plot: \code{NULL} (do not save, default),
\code{TRUE} (automatically saves as PNG with default name), or a file path with extension
(\code{.png}, \code{.pdf}, \code{.jpeg}, \code{.tiff}, \code{.svg}, \code{.eps}) to save in a specific format.}

\item{plot_width}{Plot width in inches for saved plots (default: 10).}

\item{plot_height}{Plot height in inches for saved plots (default: 8).}

\item{plot_dpi}{Resolution for saved raster images (default: 600).}

\item{axis_label_size}{Font size for axis labels (default: 14).}

\item{axis_text_size}{Font size for axis numbers (default: 14).}

\item{x_axis_title}{Custom x-axis title. If NULL, uses default expression.}

\item{y_axis_title}{Custom y-axis title. If NULL, uses default based on normalization.}

\item{enforce_bottom_threshold}{Logical indicating whether bottom threshold enforcement
was used in analysis (default: NULL, auto-detected from results).}

\item{bottom_threshold}{Numeric value for bottom threshold (default: 60).}

\item{verbose}{Logical indicating whether to show verbose messages (default: FALSE).}
}
\value{
Returns a ggplot object with comprehensive metadata stored as attributes:
\itemize{
\item \code{compound_name}: Name of the plotted compound
\item \code{compound_index}: Index of the plotted compound
\item \code{model_success}: Whether model fitting was successful
\item \code{summary_data}: Data frame with summarized plotting data
\item \code{plot_config}: Configuration settings used for plotting
\item \code{y_limits_used}: Y-axis limits actually used
\item \code{data_points}: Number of data points plotted
\item \code{concentration_levels}: Number of concentration levels
\item \code{file_saved}: Path to saved file if plot was saved
\item \code{plot_dimensions}: Dimensions of the plot (width, height, dpi)
\item \code{timestamp}: Time when plot was generated
\item \code{ic50_excluded}: Whether IC50 was excluded due to threshold
\item \code{log_ic50}: Log IC50 value if available
}
}
\description{
Generates publication-quality dose-response plots using ggplot2 from analysis results.
Features professional styling, error bars, fitted curves, IC50 visualization, and
multiple export formats. Optimized for scientific publications.
}
\details{
This function creates professional-quality dose-response plots using ggplot2,
providing superior visual quality and customization compared to base R graphics.
The function automatically handles data validation, curve fitting visualization,
and professional styling suitable for scientific publications.

\strong{Key Features:}
\itemize{
\item \strong{Professional Styling}: Clean, publication-ready appearance with bold axis labels
\item \strong{Smart IC50 Handling}: Only shows IC50 line when valid value exists
\item \strong{Error Bar Management}: Automatic handling of replicate data
\item \strong{Threshold Awareness}: Detects and handles IC50 exclusion due to bottom thresholds
\item \strong{Self-Contained}: No external package loading required
\item \strong{Comprehensive Metadata}: Detailed information about the plot and data
}

\strong{Plot Elements:}
\itemize{
\item Data points with optional error bars (standard deviation)
\item Fitted dose-response curve (when model converged)
\item Vertical IC50 line (only when valid IC50 exists)
\item Left-aligned parameter legend with IC50 and R2 values
\item Professional axis formatting with customizable titles
\item Optional background grid for better readability
}

\strong{Supported Export Formats:}
\itemize{
\item PNG (high-resolution, recommended for publications)
\item JPEG (good for presentations)
\item TIFF (lossless compression)
\item PDF (vector format, scalable)
\item SVG (vector format, editable)
}
}
\section{Plot Customization}{

The function provides extensive customization options while maintaining professional quality:
\itemize{
\item \strong{Visual Elements}: Customize colors, sizes, and styling of all plot components
\item \strong{Layout Control}: Adjust dimensions, resolution, and aspect ratio
\item \strong{Content Toggle}: Show/hide legend, grid, IC50 line, and error bars
\item \strong{Text Formatting}: Control font sizes and axis labels
\item \strong{Export Quality}: Multiple formats with quality and resolution control
}
}

\section{Automatic Features}{

\itemize{
\item Automatic input validation and error handling
\item Smart detection of threshold-based IC50 exclusion
\item Automatic directory creation for saved plots
\item Intelligent error bar display (only when meaningful data exists)
\item Graceful handling of failed model fits with clear indication
\item Professional axis formatting with appropriate scientific notation
\item Compound name extraction and clean display
}
}

\examples{
\dontrun{
# Perform dose-response analysis first
analysis_results <- fit_drc_3pl(my_data, normalize = TRUE)

# Basic plot for first compound
p <- plot_dose_response(analysis_results)
print(p)

# Customized plot with specific styling
p <- plot_dose_response(
  results = analysis_results,
  compound_index = 2,
  point_color = "blue",
  line_color = "darkred",
  show_grid = TRUE,
  y_limits = c(0, 200)
)
print(p)

# Save plot automatically with compound name
p <- plot_dose_response(
  results = analysis_results,
  compound_index = 1,
  save_plot = TRUE  # Saves as "dose_response_CompoundName.png"
)

# Save plot to specific file with custom dimensions
p <- plot_dose_response(
  results = analysis_results,
  save_plot = "my_plot.pdf",
  plot_width = 8,
  plot_height = 6
)

# Access plot metadata
p <- plot_dose_response(analysis_results, compound_index = 3)
meta <- attr(p, "metadata")
print(meta$compound_name)
print(meta$data_points)
print(meta$log_ic50)
}

}
\references{
For visualization best practices in scientific publications:
\itemize{
\item Nature Scientific Figures Guidelines
\item ggplot2: Elegant Graphics for Data Analysis (Springer)
\item R Graphics Cookbook (O'Reilly)
}
}
\seealso{
\code{\link{fit_drc_3pl}} for generating analysis results
\code{\link[ggplot2]{ggplot}} for underlying plotting functionality
\code{\link[ggplot2]{ggsave}} for plot export functionality
}
