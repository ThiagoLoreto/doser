% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_dose_response.R
\name{plot_dose_response}
\alias{plot_dose_response}
\title{Plot Dose-Response Curves with Professional Styling}
\usage{
plot_dose_response(
  results,
  compound_index = 1,
  y_limits = c(0, 150),
  point_color = "black",
  line_color = "red",
  ic50_line_color = "gray",
  point_size = 1,
  line_width = 2,
  error_bar_width = 0.01,
  show_ic50_line = TRUE,
  show_legend = TRUE,
  show_grid = FALSE,
  save_plot = NULL,
  plot_width = 10,
  plot_height = 8,
  plot_dpi = 600,
  axis_label_cex = 1.4,
  axis_number_cex = 1.4,
  x_axis_title = NULL,
  y_axis_title = NULL,
  enforce_bottom_threshold = NULL,
  bottom_threshold = 60
)
}
\arguments{
\item{results}{List object returned by \code{\link{fit_dose_response}} containing
dose-response analysis results.}

\item{compound_index}{Numeric index specifying which compound to plot (default: 1).}

\item{y_limits}{Numeric vector of length 2 specifying y-axis limits (default: c(0, 150)).}

\item{point_color}{Color for data points (default: "black").}

\item{line_color}{Color for fitted curve (default: "red").}

\item{ic50_line_color}{Color for IC50 vertical line (default: "gray").}

\item{point_size}{Size multiplier for data points (default: 1).}

\item{line_width}{Line width for fitted curve (default: 2).}

\item{error_bar_width}{Width of error bar ends (default: 0.01).}

\item{show_ic50_line}{Logical indicating whether to show vertical IC50 line (default: TRUE).}

\item{show_legend}{Logical indicating whether to show parameter legend (default: TRUE).}

\item{show_grid}{Logical indicating whether to show background grid (default: FALSE).}

\item{save_plot}{Either a file path for saving the plot, or TRUE for automatic naming
(default: NULL, no saving).}

\item{plot_width}{Plot width in inches for saved plots (default: 10).}

\item{plot_height}{Plot height in inches for saved plots (default: 8).}

\item{plot_dpi}{Resolution for saved raster images (default: 600).}

\item{axis_label_cex}{Character expansion factor for axis labels (default: 1.4).}

\item{axis_number_cex}{Character expansion factor for axis numbers (default: 1.4).}

\item{x_axis_title}{Custom x-axis title. If NULL, uses default expression
(default: NULL).}

\item{y_axis_title}{Custom y-axis title. If NULL, uses default based on
normalization status (default: NULL).}
}
\value{
Invisibly returns a list containing plot metadata:
\itemize{
\item \code{compound_name}: Name of the plotted compound
\item \code{compound_index}: Index of the plotted compound
\item \code{model_success}: Whether model fitting was successful
\item \code{summary_data}: Data frame with summarized plotting data
\item \code{plot_config}: Configuration settings used for plotting
\item \code{y_limits_used}: Y-axis limits actually used
\item \code{data_points}: Number of data points plotted
\item \code{concentration_levels}: Number of concentration levels
\item \code{file_saved}: Path to saved file if plot was saved
\item \code{plot_dimensions}: Dimensions of the plot (width, height, dpi)
\item \code{timestamp}: Time when plot was generated
}
}
\description{
Generates publication-quality dose-response plots from analysis results.
Supports error bars, fitted curves, IC50 lines, and multiple export formats.
}
\details{
This function creates professional-quality dose-response plots suitable for
publications and presentations. Key features include:

\strong{Plot Elements:}
\itemize{
\item Data points with error bars (standard deviation)
\item Fitted dose-response curve (when model converged)
\item Vertical IC50 line with dashed style
\item Parameter legend with IC50 and R2 values
\item Professional axis labels and formatting
\item Optional background grid
}

\strong{Supported Export Formats:}
\itemize{
\item PNG (high-resolution, recommended for publications)
\item JPEG (good for presentations)
\item TIFF (lossless compression)
\item PDF (vector format, scalable)
\item SVG (vector format, editable)
}
}
\section{Plot Customization}{

The function provides extensive customization options:
\itemize{
\item \strong{Colors}: Customize points, lines, and IC50 marker
\item \strong{Sizes}: Adjust point sizes, line widths, and error bars
\item \strong{Axes}: Control limits, labels, and text sizes
\item \strong{Elements}: Toggle legend, grid, and IC50 line
\item \strong{Export}: Multiple formats with quality control
}
}

\section{Automatic Features}{

\itemize{
\item Automatic directory creation for saved plots
\item Smart error bar handling (only shown when meaningful)
\item Graceful handling of failed model fits
\item Professional axis formatting and labeling
\item Compound name extraction and display
}
}

\examples{
\dontrun{
# Perform dose-response analysis first
analysis_results <- fit_dose_response(my_data, normalize = TRUE)

# Basic plot for first compound
plot_dose_response(analysis_results)

# Customized plot with specific styling
plot_dose_response(
  results = analysis_results,
  compound_index = 2,
  point_color = "blue",
  line_color = "darkred",
  show_grid = TRUE,
  y_limits = c(0, 200)
)

# Save plot automatically with compound name
plot_dose_response(
  results = analysis_results,
  compound_index = 1,
  save_plot = TRUE  # Saves as "dose_response_CompoundName.png"
)

# Save plot to specific file with custom dimensions
plot_dose_response(
  results = analysis_results,
  save_plot = "my_plot.pdf",
  plot_width = 8,
  plot_height = 6
)

# Access plot metadata
plot_info <- plot_dose_response(analysis_results, compound_index = 3)
print(plot_info$compound_name)
print(plot_info$data_points)
}

}
\references{
For visualization best practices:
\itemize{
\item Nature Scientific Figures Guidelines
\item R Graphics Cookbook (O'Reilly)
}
}
\seealso{
\code{\link{fit_dose_response}} for generating analysis results
\code{\link[graphics]{plot}} for base plotting functions
\code{\link[grDevices]{png}} for plot export options
}
