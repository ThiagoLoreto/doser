% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_drc_batch.R
\name{plot_drc_batch}
\alias{plot_drc_batch}
\title{Plot Dose-Response Curves (DRC) from Batch Analysis Results}
\usage{
plot_drc_batch(
  batch_drc_results,
  construct_compound = NULL,
  position = NULL,
  y_limits = NULL,
  colors = NULL,
  point_shapes = NULL,
  show_error_bars = TRUE,
  legend_position = "right",
  show_legend = TRUE,
  shape_by_duplicate = FALSE,
  show_grid = FALSE,
  font_family = "sans",
  facet_by = NULL,
  facet_ncol = NULL,
  facet_scales = "fixed",
  save_plot = NULL,
  plot_width = 12,
  plot_height = 8,
  plot_dpi = 600,
  plot_title = NULL,
  legend_title = NULL,
  y_axis_title = NULL,
  verbose = TRUE,
  axis_text_color = "black",
  axis_text_size = 12,
  axis_title_color = "black",
  axis_title_size = 14
)
}
\arguments{
\item{batch_drc_results}{A named list containing the results of the DRC batch analysis.
Structure expected: \code{list(plate_name = list(drc_result = list(detailed_results = ...)))}.
Can also accept a wrapper object from \code{batch_drc_analysis()} which contains a \code{drc_results} element.}

\item{construct_compound}{Character string. The specific construct/compound to plot.
Supports two formats:
\itemize{
\item \strong{"Construct:Compound"}: Performs an exact match (e.g., "PAK3:IPA-3").
\item \strong{"SearchString"}: Performs a fuzzy search across constructs and compounds (e.g., "IPA-3").
}
Ignored if \code{position} is provided.}

\item{position}{Integer. Selects a compound by its numerical index in the list of unique results.
Useful for iterating through compounds blindly.}

\item{y_limits}{Numeric vector of length 2 (e.g., \code{c(0, 150)}). Sets the Y-axis limits.
Applied using \code{coord_cartesian()} to maintain all data points (no filtering).
If \code{NULL} (default), limits are automatic.
\emph{Note:} Ignored if \code{facet_scales} contains "free".}

\item{colors}{Character vector or string. Controls the line/point colors. Accepts:
\itemize{
\item \strong{Manual colors}: A vector of color codes/names (e.g., \code{c("red", "blue")}).
\item \strong{Single color name}: Any valid R color name (e.g., "red", "blue", "darkgreen").
\item \strong{Viridis palettes}: "viridis", "magma", "plasma", "inferno", "cividis", "turbo", "rocket", "mako".
Requires \code{viridisLite} package.
\item \strong{RColorBrewer palettes}: Names like "Set1", "Set2", "Set3", "Pastel1", "Pastel2",
"Paired", "Dark2", "Accent". Requires \code{RColorBrewer} package.
\item \strong{ggsci palettes}: "jama", "nature" (npg), "lancet", "nejm", "aaas", "d3", "locuszoom",
"igv", "uchicago", "startrek", "tron", "futurama", "rickandmorty", "simpsons", "gsea".
Requires \code{ggsci} package.
}
Palettes are automatically interpolated if more colors are needed than the palette provides.}

\item{point_shapes}{Integer vector. Custom shapes for points (0-25). Used only if \code{shape_by_duplicate = TRUE}.}

\item{show_error_bars}{Logical. If \code{TRUE} (default), adds error bars (mean +/- SD) to the points.}

\item{legend_position}{Character. Position of the legend ("right", "bottom", "top", "none").}

\item{show_legend}{Logical. Whether to display the legend.}

\item{shape_by_duplicate}{Logical. If \code{TRUE} and plotting a single compound group,
different replicates (plates) will have different point shapes.}

\item{show_grid}{Logical. If \code{TRUE}, displays grid lines. If \code{FALSE} (default),
produces a clean "classic" scientific style (axis lines only).}

\item{font_family}{Character. Font family for text elements.
Common options: "sans" (Arial/Helvetica), "serif" (Times New Roman), "mono" (Courier).
For custom fonts, use the \code{extrafont} package.}

\item{facet_by}{Character. Variable to split the plot into panels.
Options: \code{"compound"}, \code{"construct"}, \code{"plate"}. Default is \code{NULL} (single plot).}

\item{facet_ncol}{Integer. Number of columns for the faceted grid.}

\item{facet_scales}{Character. Scaling of axes in facets.
Options: \code{"fixed"} (default), \code{"free"}, \code{"free_y"}, \code{"free_x"}.}

\item{save_plot}{Character string. File path to save the plot (e.g., "plot.png", "plot.pdf").
If \code{NULL}, the plot is not saved automatically.}

\item{plot_width}{Numeric. Width of the saved plot in inches (default: 12).}

\item{plot_height}{Numeric. Height of the saved plot in inches (default: 8).}

\item{plot_dpi}{Integer. Resolution of the saved plot (default: 600).}

\item{plot_title}{Character. Custom main title. If \code{NULL}, generates a smart title based on selection.}

\item{legend_title}{Character. Custom legend title. If \code{NULL}, generates based on data.}

\item{y_axis_title}{Character. Custom Y-axis title. Default is "Response".}

\item{verbose}{Logical. If \code{TRUE} (default), prints progress messages to the console.}

\item{axis_text_color}{Character. Color of axis tick labels (default: "black").}

\item{axis_text_size}{Numeric. Size of axis tick labels (default: 12).}

\item{axis_title_color}{Character. Color of axis titles (default: "black").}

\item{axis_title_size}{Numeric. Size of axis titles (default: 14).}
}
\value{
A \code{ggplot2} object. This allows further modification using standard ggplot syntax
(e.g., \code{plot + theme_dark()}).
}
\description{
This function generates publication-quality Dose-Response Curve (DRC) plots from a list of
batch processing results. It handles data extraction, statistical aggregation, and visualization
in a single step. It supports advanced features like scientific color palettes, faceting,
and custom styling.
}
\details{
\strong{Data Extraction:} The function iterates through the nested list structure of \code{batch_drc_results},
extracting raw data points and model predictions for valid fits. Curve predictions are generated
only within the range of experimental data (no extrapolation).

\strong{Curve Behavior:} Model curves are plotted only within the concentration range of the
experimental data for each curve, avoiding extrapolation beyond measured points.

\strong{Error Bars:} When multiple replicates exist at the same concentration, error bars
represent mean Â± standard deviation.

\strong{Faceting vs. Limits:} If \code{facet_scales} is set to "free" or "free_y", the global \code{y_limits}
argument will be ignored to allow each panel to scale independently.

\strong{Automatic Title Generation:} When \code{plot_title = NULL}, the function generates
appropriate titles:
\itemize{
\item Single compound: Compound name
\item Multiple compounds, single construct: Construct name
\item Multiple compounds, single compound name: Compound name
\item Otherwise: "Comparative DRC Analysis"
}
}
\examples{
\dontrun{
# 1. Basic usage: Plot specific compound by name
plot_drc_batch(results, construct_compound = "PAK3:IPA-3")

# 2. Search fuzzy match and use JAMA colors
plot_drc_batch(results, construct_compound = "IPA-3", colors = "jama")

# 3. Plot by position (e.g., the 5th compound found)
plot_drc_batch(results, position = 5)

# 4. Facet by compound (compare multiple compounds side-by-side)
plot_drc_batch(results,
               construct_compound = "PAK3",
               facet_by = "compound",
               facet_ncol = 3)

# 5. Custom styling with y-limits and viridis palette
plot_drc_batch(results,
               construct_compound = "ConstructA:CompB",
               colors = "viridis",
               y_limits = c(0, 150),
               font_family = "serif",
               show_grid = FALSE)

# 6. Save plot automatically
plot_drc_batch(results,
               construct_compound = "PAK4:MRIA-9",
               save_plot = "PAK4_MRIA9_DRC.png",
               plot_width = 10,
               plot_height = 6)
}

}
\seealso{
\code{\link{batch_drc_analysis}} for generating batch DRC results
\code{\link{batch_save_all_drc_plots}} for automatically saving all DRC plots
\code{\link[ggplot2]{ggplot}} for underlying plotting functionality
}
