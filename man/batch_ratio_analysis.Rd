% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/batch_ratio_analysis.R
\name{batch_ratio_analysis}
\alias{batch_ratio_analysis}
\title{Batch Processing of Ratio-Based Dose-Response Analyses}
\usage{
batch_ratio_analysis(
  directory = getwd(),
  control_0perc = NULL,
  control_100perc = NULL,
  split_replicates = TRUE,
  low_value_threshold = 1000,
  info_file = "info_tables.xlsx",
  data_pattern = "_\\\\d+\\\\.xlsx$",
  output_dir = NULL,
  generate_reports = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{directory}{Path to the folder containing all raw data files and the
info table file. Defaults to the current working directory.}

\item{control_0perc}{Value or identifier of the \strong{0\% control} (minimum).
Passed directly to \code{ratio_dose_response()}.}

\item{control_100perc}{Value or identifier of the \strong{100\% control} (maximum).
Passed directly to \code{ratio_dose_response()}.}

\item{split_replicates}{Logical. If \code{TRUE} (default), replicates are processed
individually inside \code{ratio_dose_response()}.}

\item{low_value_threshold}{Minimum acceptable signal value for filtering
low-quality data.}

\item{info_file}{Name of the Excel file containing info sheets for each plate.
Defaults to \code{"info_tables.xlsx"}.}

\item{data_pattern}{Regular expression used to find raw data files. The default
(\code{"_\\\\d+\\\\.xlsx$"}) matches filenames such as \code{"data_01.xlsx"} and \code{"plate_12.xlsx"}.}

\item{output_dir}{Directory where processed result files and consolidated
reports will be saved. If \code{NULL}, defaults to \code{directory}.}

\item{generate_reports}{If \code{TRUE} (default), creates a consolidated
\code{batch_analysis_report.xlsx} file containing a summary and quality metrics
for all processed plates.}

\item{verbose}{Logical. If \code{TRUE}, prints progress messages.}
}
\value{
Returns a named list where each element corresponds to a successfully processed
plate/experiment.

Each entry contains:
\describe{
\item{data_file}{Raw data filename associated with the sheet.}
\item{info_sheet}{Name of the info sheet used.}
\item{sheet_number}{Numeric identifier extracted from the sheet name.}
\item{result}{Full output of \code{ratio_dose_response()}.}
}

If \code{generate_reports = TRUE}, an Excel file
\code{"batch_analysis_report.xlsx"}
is also created in \code{output_dir}.
}
\description{
\code{batch_ratio_analysis()} automates the batch processing of multiple
ratio-based dose–response experiments.
It scans an info table file (typically \code{info_tables.xlsx}) containing one
sheet per plate/experiment, identifies sheets whose names end with a numeric
suffix (e.g., \code{"Plate_01"}, \code{"Exp_03"}, \code{"05"}), and automatically pairs each
sheet with the corresponding raw data file.

\strong{Important:}
The numeric suffix of the sheet name \strong{must match} the numeric identifier in
the raw data filename. Example:

• Sheet name: \code{"Plate_01"} → numeric ID: \code{"01"}
• Raw data file: \code{"data_01.xlsx"}

This numeric matching is required for the batch processing to correctly link
each info sheet with its corresponding data file.

The function runs \code{\link[=ratio_dose_response]{ratio_dose_response()}} for each matched pair, saves
individual results, and optionally generates a consolidated Excel report.
}
\details{
The function performs the following steps:
\enumerate{
\item Loads the info table file and identifies all sheet names ending with a
numeric suffix.
\item Extracts the numeric portion from each sheet name (e.g., \code{"Plate_03"} → \code{"03"}).
\item Searches for a raw data file in \code{directory} whose filename contains the
\emph{same} numeric identifier.

\strong{This numeric matching is required} for the function to determine which
raw data file corresponds to which info sheet.
If the sheet is \code{"Exp_07"}, the data file must contain \code{"_07.xlsx"}.
\item Reads the raw data and the corresponding info table.
\item Executes \code{\link[=ratio_dose_response]{ratio_dose_response()}} for each matched pair.
\item Saves per-plate results into Excel files (\verb{results_<number>.xlsx}) unless
\code{generate_reports = FALSE}.
\item Optionally generates a consolidated report containing:
\itemize{
\item A "Summary" sheet with plate status, number of constructs, data file used,
and overall quality classification.
\item Individual sheets containing interval mean tables (\code{interval_means}) for
each processed plate.
}
}
}
\examples{
\dontrun{

# Basic usage (using current working directory):
batch_ratio_analysis()

# Running with specified controls and output directory:
batch_ratio_analysis(
  directory = "experiment_data",
  control_0perc = "DMSO",
  control_100perc = "Positive_Control",
  output_dir = "processed_results"
)

# Running without generating the consolidated report:
batch_ratio_analysis(
  directory = "raw_data",
  generate_reports = FALSE
)

}


}
\seealso{
\itemize{
\item \code{\link[=ratio_dose_response]{ratio_dose_response()}} – The function executed for each matched plate.
\item \code{openxlsx} – Package used for reading and writing Excel files.
}
}
