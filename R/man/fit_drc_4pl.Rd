% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_drc_4pl.R
\name{fit_drc_4pl}
\alias{fit_drc_4pl}
\title{Dose-Response Curve Analysis using 4-Parameter Logistic Model}
\usage{
fit_drc_4pl(
  data,
  output_file = NULL,
  normalize = FALSE,
  verbose = TRUE,
  enforce_bottom_threshold = FALSE,
  bottom_threshold = 60,
  r_sqr_threshold = 0.8
)
}
\arguments{
\item{data}{A data.frame where the first column contains log inhibitor concentrations
and subsequent columns contain response values in duplicate pairs.}

\item{output_file}{Optional character string specifying path to save results.
Supports .csv and .xlsx formats.}

\item{normalize}{Logical indicating whether to normalize response data to 0-100\%
based on first and last data points. Default is FALSE.}

\item{verbose}{Logical indicating whether to display detailed progress messages.
Default is FALSE.}

\item{enforce_bottom_threshold}{Logical indicating whether to exclude IC50 values
for inhibition curves where Bottom parameter exceeds threshold. Default is FALSE.}

\item{bottom_threshold}{Numeric value (0-100) for Bottom parameter above which
IC50 values are excluded for inhibition curves. Default is 60.}

\item{r_sqr_threshold}{Numeric value (0-1) for minimum R-squared to consider
curve fit acceptable. Default is 0.5.}
}
\value{
A list containing:
\itemize{
\item \code{summary_table}: Data.frame with fitted parameters, confidence intervals,
and quality metrics for all compounds
\item \code{detailed_results}: List of detailed fitting results for each compound
\item \code{n_compounds}: Number of compounds analyzed
\item \code{successful_fits}: Number of successful model fits
\item \code{normalized}: Logical indicating if data was normalized
\item \code{original_data}: Original input data
\item \code{processed_data}: Processed data used for analysis
\item \code{threshold_settings}: Settings for bottom threshold enforcement
\item \code{parameter_order_corrections}: Number of parameter order corrections applied
}
}
\description{
Fits 4-parameter logistic (4PL) models to dose-response data for both inhibition
and activation curves. Automatically detects curve type, applies biological
plausibility checks, and provides comprehensive curve quality assessment.
}
\details{
The function uses a 4-parameter logistic model:
\deqn{Response = Bottom + \frac{Top - Bottom}{1 + 10^{(log_{10}(inhibitor) - LogIC50) \times HillSlope}}}

Key features:
\itemize{
\item Automatic detection of inhibition (HillSlope < 0) vs activation (HillSlope > 0) curves
\item Biological plausibility checks with parameter corrections when needed
\item Multiple starting value strategies for robust convergence
\item Comprehensive curve quality assessment based on multiple metrics
\item Confidence interval calculation via profiling or normal approximation
}
}
\section{Data Format}{

Input data should be structured as:
\preformatted{
log_inhibitor | Compound1_rep1 | Compound1_rep2 | Compound2_rep1 | Compound2_rep2 | ...
-3.0 | 45.2 | 47.8 | 32.1 | 30.9 | ...
-2.0 | 38.7 | 40.1 | 28.5 | 29.2 | ...
-1.0 | 25.4 | 23.9 | 45.6 | 47.2 | ...
0.0 | 15.2 | 16.8 | 62.3 | 60.9 | ...
}
}

\section{Biological Plausibility Limits}{

\itemize{
\item Bottom: -100 to 600 (inhibition) or -100 to Inf (activation)
\item Top: 0 to 700
\item LogIC50: -10 to 2
\item HillSlope: -5 to 5
}
}

\section{Curve Quality Assessment}{

Curves are classified based on:
\itemize{
\item R-squared < threshold: "Low R2"
\item Maximum slope < 5: "Very shallow slope"
\item Maximum slope < 15: "Shallow slope"
\item Span < 20: "Small span"
\item Parameter corrections: "Parameters corrected"
\item logIC50 range (>0.666 flagged)
}
}

\examples{
# Example with dummy data
data <- data.frame(
  log_inhibitor = c(-2, -1, 0, 1, 2),
  compound1_rep1 = c(100, 80, 50, 30, 10),
  compound1_rep2 = c(102, 82, 48, 28, 12)
)
result <- fit_drc_4pl(data, normalize = TRUE, verbose = TRUE)
head(result$summary_table)

}
