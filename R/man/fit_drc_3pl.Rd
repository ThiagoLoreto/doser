% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_dose_response.R
\name{fit_drc_3pl}
\alias{fit_drc_3pl}
\title{Fit a 3-Parameter Logistic Dose-Response Model}
\usage{
fit_drc_3pl(
  data,
  output_file = NULL,
  normalize = FALSE,
  verbose = TRUE,
  enforce_bottom_threshold = FALSE,
  bottom_threshold = 60,
  r_sqr_threshold = 0.8
)
}
\arguments{
\item{data}{A data frame containing dose-response data. The first column should
contain log10(inhibitor concentration) values, followed by pairs of response
columns (duplicate measurements).}

\item{output_file}{Optional character string specifying the output file path.
Supports both Excel (.xlsx) and CSV formats.}

\item{normalize}{Logical indicating whether to normalize response data.
If TRUE, responses are normalized from 0-100\% based on the first and last values.
Default is FALSE.}

\item{verbose}{Logical indicating whether to display progress messages and
summary statistics. Default is TRUE}

\item{enforce_bottom_threshold}{Logical indicating whether to exclude IC50 values
for curves where the Bottom parameter exceeds a threshold. Default is FALSE.}

\item{bottom_threshold}{Numeric value specifying the Bottom threshold when
\code{enforce_bottom_threshold = TRUE}. Curves with Bottom <= this value will have
IC50 values set to NA. Default is 60.}

\item{r_squared_threshold}{Numeric value between 0 and 1 specifying the R2 cutoff
for curve quality assessment. Curves with R2 below this value will be flagged
as "Low R2" in the quality assessment (default: 0.8).}
}
\value{
A list containing the following components:
\itemize{
\item \code{summary_table}: Data frame with fitted parameters for all compounds
\item \code{detailed_results}: List containing detailed fitting results for each compound
\item \code{n_compounds}: Number of compounds analyzed
\item \code{successful_fits}: Number of successful curve fits
\item \code{normalized}: Logical indicating if data was normalized
\item \code{original_data}: Original input data
\item \code{processed_data}: Processed data (normalized if requested)
\item \code{threshold_settings}: List with threshold settings and affected compounds (if applicable)
}
}
\description{
The \code{fit_drc_3pl()} function fits a three-parameter logistic (3PL) dose-response
model to experimental data. It supports duplicate measurements, normalization,
and optional filtering of low bottom values. The function computes fitted parameters,
model statistics, and diagnostic metrics, providing a concise summary of model performance.
}
\details{
This function performs comprehensive dose-response analysis using the following steps:

\strong{Data Structure:}
\itemize{
\item First column: log10(inhibitor concentration) values
\item Subsequent columns: Pairs of response measurements (technical duplicates)
\item Example: Column1 = log_conc, Column2 = Response1, Column3 = Response2, Column4 = Response3, Column5 = Response4, etc.
}

\strong{Model Fitting:}
\itemize{
\item Uses 3-parameter logistic model with fixed Hill slope of -1
\item Implements multiple starting value strategies for robust convergence
\item Includes biological plausibility checks and automatic parameter corrections
\item Calculates ideal Hill slope using 4-parameter model for comparison
}

\strong{Output Parameters:}
\itemize{
\item Bottom: Minimum response asymptote
\item Top: Maximum response asymptote
\item LogIC50: log10(IC50) value
\item IC50: Half-maximal inhibitory concentration
\item Span: Top - Bottom (response range)
\item Confidence intervals for all parameters
\item Goodness-of-fit metrics (R2, Syx, etc.)
\item Curve quality assessment
\item Maximum slope and ideal Hill slope
}
}
\section{Data Format}{

The input data should be structured as follows:
\preformatted{
  log_conc  Targ/Comp1_rep1  Targ/Comp1_rep2  Targ/Comp2_rep1  Targ/Comp2_rep2 ...
    NA      25.1              25.1            25.1            25.1
  -8.0      30.5              31.2            22.1            23.4
  -7.0      45.2              46.8            35.6            36.9
  ...       ...            ...             ...             ...
}
}

\section{Curve Quality Assessment}{

Curves are automatically assessed for quality based on:
\itemize{
\item Maximum slope (shallow curves flagged)
\item Response span (<20\% flagged)
\item R-squared values (<0.5 flagged)
\item Biological plausibility of parameters
\item logIC50 range (>0.666 flagged)
}
}

\examples{
\dontrun{
# Basic usage with example data
results <- fit_dose_response(dose_response_data)

# With normalization and output file
results <- fit_dose_response(
  data = my_data,
  output_file = "results.xlsx",
  normalize = TRUE
)

# With bottom threshold enforcement
results <- fit_dose_response(
  data = my_data,
  enforce_bottom_threshold = TRUE,
  bottom_threshold = 60
)

# Access results
summary_table <- results$summary_table
successful_fits <- results$successful_fits

# View curve quality distribution
table(results$summary_table$Curve_Quality)
}

}
\references{
For methodological details on dose-response analysis:
\itemize{
\item GraphPad Prism Curve Fitting Guide
\item NIH Assay Guidance Manual
}
}
\seealso{
Useful related functions:
\itemize{
\item \code{\link[=plot_dose_response]{plot_dose_response()}} for plotting results
\item plot_multiple_compounds() for exporting results
\item save_multiple_sheets() for saving results to Excel
\item \code{\link[stats]{nls}} for nonlinear regression details
}
}
