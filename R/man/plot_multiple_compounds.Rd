% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_multiple_compounds.R
\name{plot_multiple_compounds}
\alias{plot_multiple_compounds}
\title{Plot Multiple Dose-Response Curves}
\usage{
plot_multiple_compounds(
  results,
  compound_indices = NULL,
  y_limits = c(0, 150),
  point_shapes = NULL,
  colors = FALSE,
  legend_position = "right",
  show_grid = FALSE,
  show_legend = TRUE,
  save_plot = NULL,
  plot_width = 10,
  plot_height = 8,
  plot_dpi = 600,
  axis_label_size = 14,
  axis_text_size = 14,
  show_error_bars = TRUE,
  error_bar_width = 0.05,
  plot_title = NULL,
  legend_text_size = NULL,
  legend_title_size = 11,
  legend_key_height = NULL,
  legend_ncol = NULL,
  legend_label_wrap = 25,
  plot_ratio = 0.7,
  legend_title = NULL,
  legend_labels = NULL
)
}
\arguments{
\item{results}{A list containing results from dose-response analysis.
Expected to include a sublist \code{detailed_results}, where each
element contains at least \code{model}, \code{data}, \code{success}, and \code{compound}.}

\item{compound_indices}{Numeric vector specifying which compounds to include in the plot
If \code{NULL} (default), all available compounds in \code{results$detailed_results}
are included.}

\item{y_limits}{Numeric vector of length 2 specifying the y-axis limits}

\item{point_shapes}{Numeric vector of point shapes for different compounds}

\item{colors}{Character vector of colors for different compound curves
\itemize{
\item \code{FALSE} (default): all curves and points are black;
\item \code{TRUE}: automatically assigns distinct colors (via \code{scales::hue_pal()});
\item Character vector of custom colors (recycled if shorter than the number of compounds).
}}

\item{legend_position}{Position of the legend: one of \code{"right"}, \code{"left"},
\code{"top"}, \code{"bottom"}, or \code{"none"}. Default: \code{"right"}.}

\item{show_grid}{Logical indicating whether to show background grid lines}

\item{show_legend}{Logical indicating whether to display the legend}

\item{save_plot}{Defines whether to save the plot: \code{NULL} (do not save, default),
\code{TRUE} (automatically saves as PNG with default name), or a file path with extension
(\code{.png}, \code{.pdf}, \code{.jpeg}, \code{.tiff}, \code{.svg}, \code{.eps}) to save in a specific format.}

\item{plot_width, plot_height}{Plot dimensions (in inches) when saving.}

\item{plot_dpi}{Resolution (in DPI) for saved plots. Default: \code{600}.}

\item{axis_label_size}{Numeric value for axis title font size}

\item{axis_text_size}{Numeric value for axis tick label font size}

\item{show_error_bars}{Logical indicating whether to display error bars around data points}

\item{error_bar_width}{Numeric value controlling the width of error bars}

\item{plot_title}{Custom plot title. If \code{NULL}, a smart title is generated
automatically based on the compound names.}

\item{legend_text_size}{Numeric value for legend text font size}

\item{legend_title_size}{Numeric value for legend title font size}

\item{legend_key_height}{Height (in points) of legend keys. Automatically adjusted.}

\item{legend_ncol}{Numeric value specifying number of columns in legend}

\item{legend_label_wrap}{Maximum character width before legend labels
automatically wrap to new lines. Default: \code{25}.}

\item{plot_ratio}{Numeric value for plot aspect ratio (width/height)}

\item{legend_title}{Title for the legend (displayed above symbols).}

\item{legend_labels}{Character vector of custom labels for legend (overrides target/compound names)}
}
\value{
ggplot object with additional metadata stored as attribute containing:
\itemize{
\item compound_names: Original compound names
\item compound_indices: Indices used for plotting
\item n_compounds: Number of valid compounds plotted
\item point_shapes: Point shapes used
\item colors: Colors used
\item legend_position: Legend position
\item legend_ncol: Number of legend columns
\item legend_text_size: Legend text size
\item legend_key_height: Legend key height
\item legend_title: Legend title used
\item legend_labels_used: Legend labels actually used
\item wrapped_labels: Labels after text wrapping applied
\item x_limits: X-axis limits used
\item plot_dimensions: Plot dimensions and resolution
\item file_saved: Filename if plot was saved
\item smart_title_used: Title actually displayed on plot
}
}
\description{
The \code{plot_multiple_compounds()} function generates a consolidated plot of
fitted dose-response curves for multiple compounds, allowing visual
comparison between different responses. It provides extensive customization
options for colors, shapes, titles, legends, gridlines, and file export.
}
\details{
This function overlays fitted dose-response curves (based on nonlinear models)
together with empirical mean Â± SD values for each concentration, allowing
direct visual comparison across multiple compounds or experimental conditions.

\strong{Key Features:}
\itemize{
\item \strong{Black-and-white optimized}: Default uses black lines with distinct point shapes
\item \strong{Smart point selection}: Automatically chooses optimal point shapes based on compound count
\item \strong{Adaptive sizing}: Point sizes and legend elements adjust based on number of compounds
\item \strong{Intelligent text wrapping}: Automatically wraps long compound names in legend
\item \strong{Professional styling}: Clean, publication-ready appearance with customizable elements
\item \strong{Self-contained}: No external package loading required
}

\strong{Automatic Adjustments:}
\itemize{
\item \strong{Point shapes}: Uses most distinguishable shapes first, recycles intelligently
\item \strong{Point size}: Larger points for few compounds (3.5), smaller for many (2.5)
\item \strong{Legend text}: Smaller text for many compounds (9pt), larger for few (11pt)
\item \strong{Legend columns}: Single column for <=10 compounds, two columns for >10 compounds
\item \strong{X-axis limits}: Automatically calculated from data with 5\% margin
}
}
\examples{
\dontrun{
# Example 1: Basic plot for all compounds
p1 <- plot_multiple_compounds(results)
print(p1)

# Example 2: Select specific compounds by index
p2 <- plot_multiple_compounds(results, compound_indices = c(1, 3, 5))

# Example 3: Enable automatic coloring and save the plot
p3 <- plot_multiple_compounds(
  results,
  compound_indices = 1:4,
  colors = TRUE,
  save_plot = "plots/multi_colored_curves.png"
)

# Example 4: Customize legend labels and point shapes
p4 <- plot_multiple_compounds(
  results,
  compound_indices = 1:3,
  legend_labels = c("Compound A", "Compound B", "Compound C"),
  point_shapes = c(15, 17, 19),
  legend_title = "Treatments"
)

# Example 5: Disable error bars and use black-and-white mode
p5 <- plot_multiple_compounds(
  results,
  colors = FALSE,
  show_error_bars = FALSE,
  show_grid = TRUE,
  plot_title = "Curves without error bars"
)

# Example 6: Place legend below the plot in multiple columns
p6 <- plot_multiple_compounds(
  results,
  legend_position = "bottom",
  legend_ncol = 3,
  colors = TRUE
)

# Example 7: Plot without any legend
p7 <- plot_multiple_compounds(results, show_legend = FALSE)

# Example 8: Fine-tune fonts, limits, and title
p8 <- plot_multiple_compounds(
  results,
  compound_indices = 1:2,
  y_limits = c(0, 120),
  axis_label_size = 16,
  axis_text_size = 13,
  plot_title = "Comparison of Two Compounds"
)



# Extract metadata for reproducibility
meta <- attr(p, "metadata")
cat("Plotted", meta$n_compounds, "compounds\n")
cat("Point shapes:", meta$point_shapes, "\n")
cat("X-axis range:", round(meta$x_limits, 2), "\n")

# Save styling information
styling_info <- data.frame(
  Compound = meta$compound_names,
  PointShape = meta$point_shapes,
  Color = meta$colors
)
write.csv(styling_info, "plot_styling.csv", row.names = FALSE)
}

}
\seealso{
\code{\link{fit_drc_3pl}} for generating input data
\code{\link{fit_drc_4pl}} for generating input data
\code{\link[ggplot2]{ggplot}} for underlying plotting functionality
}
